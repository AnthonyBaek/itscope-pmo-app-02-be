# Topic01 Phase01 Task01: API 명세 설계 (api-design)

## 개요
- 목적: 인증/로그인/메인 진입에 필요한 API 명세 설계 및 문서화

> 체크리스트 ID는 topic-번호, phase-번호, task-번호, BE/FE/INT, 순번으로 구성됩니다. (예: 01-01-01-BE-01)
> 상세화 시 하위 체크리스트는 01-01-01-BE-01-01, 01-01-01-BE-01-02 등으로 추가합니다.

---

## API Specification

### 1. 로그인 API
```
POST /api/auth/login
Content-Type: application/json

Request Body:
{
  "email": "test@test.com",
  "password": "password123"
}

Success Response (200 OK):
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "tokenType": "Bearer",
  "expiresIn": 3600
}

Error Response (401 Unauthorized):
{
  "message": "이메일 또는 비밀번호가 일치하지 않습니다.",
  "timestamp": "2024-01-15T10:30:00Z"
}
```

### 2. 메인 페이지 데이터 API
```
GET /api/main
Authorization: Bearer {accessToken}

Success Response (200 OK):
{
  "message": "안녕하세요, test@test.com 님!",
  "user": {
    "email": "test@test.com",
    "name": "테스트 사용자"
  }
}

Error Response (401 Unauthorized):
{
  "message": "인증이 필요합니다.",
  "timestamp": "2024-01-15T10:30:00Z"
}
```

---

## 테스트 시나리오
1. 정상 로그인: test@test.com / password123 → JWT 토큰 발급
2. 잘못된 비밀번호: test@test.com / wrong → 401 에러
3. 존재하지 않는 이메일: none@test.com / password123 → 401 에러
4. 토큰 없이 메인 접근: Authorization 헤더 없음 → 401 에러
5. 유효한 토큰으로 메인 접근: 올바른 JWT → 사용자 정보 반환

---

## 체크리스트

### 백엔드(B/E)
1. [ ] **01-01-01-BE-01**: 요구사항 분석 및 인증 관련 엔드포인트 목록 도출
   - [ ] **01-01-01-BE-01-01**: 사용자 인증 요구사항 정의 (이메일/비밀번호 방식, 사전 등록 정책)
   - [ ] **01-01-01-BE-01-02**: JWT 토큰 정책 정의 (만료시간 3600초, HS256 알고리즘, 페이로드 구조)
   - [ ] **01-01-01-BE-01-03**: API 엔드포인트 목록 정리 (POST /api/auth/login, GET /api/main)
   - [ ] **01-01-01-BE-01-04**: API 버전 관리 정책 정의 (/api/ 경로, 하위 호환성 정책)

2. [ ] **01-01-01-BE-02**: 요청/응답 스키마 정의 (예시 JSON 포함)
   - [ ] **01-01-01-BE-02-01**: 로그인 요청 DTO 정의 (LoginRequest: email, password 필드, 검증 규칙)
   - [ ] **01-01-01-BE-02-02**: JWT 토큰 응답 DTO 정의 (LoginResponse: accessToken, tokenType, expiresIn)
   - [ ] **01-01-01-BE-02-03**: 메인 페이지 응답 DTO 정의 (MainResponse: message, user 객체 구조)
   - [ ] **01-01-01-BE-02-04**: 공통 에러 응답 DTO 정의 (ErrorResponse: message, timestamp)
   - [ ] **01-01-01-BE-02-05**: 데이터 검증 규칙 정의 (@Valid, @Email, 비밀번호 정책)

3. [ ] **01-01-01-BE-03**: 에러/예외 응답 정책 수립
   - [ ] **01-01-01-BE-03-01**: 인증 실패 에러 정의 (401 Unauthorized 시나리오, 메시지 표준화)
   - [ ] **01-01-01-BE-03-02**: 요청 검증 실패 에러 정의 (400 Bad Request, 필수 필드 누락/형식 오류)
   - [ ] **01-01-01-BE-03-03**: 서버 에러 정의 (500 Internal Server Error 처리 정책)
   - [ ] **01-01-01-BE-03-04**: 에러 로깅 정책 정의 (로그 레벨, 보안 정보 마스킹)

4. [ ] **01-01-01-BE-04**: Swagger/OpenAPI 문서 초안 작성
   - [ ] **01-01-01-BE-04-01**: OpenAPI 3.0 스펙 구조 설정 (info, servers, paths)
   - [ ] **01-01-01-BE-04-02**: 로그인 API 스웨거 문서 작성 (request/response 스키마, 예시)
   - [ ] **01-01-01-BE-04-03**: 메인 API 스웨거 문서 작성 (Authorization 헤더, 응답 예시)
   - [ ] **01-01-01-BE-04-04**: 에러 응답 스웨거 문서 작성 (401, 400, 500 상황별 예시)
   - [ ] **01-01-01-BE-04-05**: Swagger UI 설정 (Spring Boot 연동, 접근 경로 설정)

5. [ ] **01-01-01-BE-05**: API 명세서 팀 내 리뷰 및 피드백 반영
   - [ ] **01-01-01-BE-05-01**: 내부 리뷰 진행 (API 설계 검토, 보안 정책 검증)
   - [ ] **01-01-01-BE-05-02**: 프론트엔드 팀과 상호 검토 (API 호출 시나리오 검증)
   - [ ] **01-01-01-BE-05-03**: 피드백 사항 문서화 및 반영 (변경 내역 추적)
   - [ ] **01-01-01-BE-05-04**: 최종 API 명세서 승인 및 확정

### 프론트엔드(F/E)
1. [ ] **01-01-01-FE-01**: 화면/기능 흐름에 맞는 API 호출 시나리오 정리
   - [ ] **01-01-01-FE-01-01**: API 요청/응답에 대한 **TypeScript 인터페이스** 정의
   - [ ] **01-01-01-FE-01-02**: 인증 관련 **타입 정의** (User, AuthState, TokenResponse 등)

2. [ ] **01-01-01-FE-02**: Mock 데이터/Mock 서버 준비
   - [ ] **01-01-01-FE-02-01**: 로그인 폼 **Zod 검증 스키마** 정의
   - [ ] **01-01-01-FE-02-02**: API 응답 **런타임 검증 스키마** 설계

3. [ ] **01-01-01-FE-03**: API 명세서 기반 프론트엔드 통신 모듈 설계
   - [ ] **01-01-01-FE-03-01**: 로그인 API용 **TanStack Query mutation 훅** 설계
   - [ ] **01-01-01-FE-03-02**: 메인 페이지 데이터용 **TanStack Query query 훅** 설계
   - [ ] **01-01-01-FE-03-03**: **쿼리 키 네이밍 컨벤션** 정의

4. [ ] **01-01-01-FE-04**: API 명세서 리뷰 및 BE와 상호 검증

5. [ ] **01-01-01-FE-05**: 상태 관리 설계
   - [ ] **01-01-01-FE-05-01**: **Zustand Auth Store** 설계 (토큰, 사용자 정보, 로그인 상태)
   - [ ] **01-01-01-FE-05-02**: **인증 상태 persist** 설정 (localStorage 연동)

6. [ ] **01-01-01-FE-06**: 라우팅 및 보안 설계
   - [ ] **01-01-01-FE-06-01**: **보호된 라우트** (Protected Route) 컴포넌트 설계
   - [ ] **01-01-01-FE-06-02**: **라우트 구조** 정의 (/login, /main, / 등)

7. [ ] **01-01-01-FE-07**: UI 컴포넌트 설계
   - [ ] **01-01-01-FE-07-01**: 로그인 폼에 필요한 **shadcn/ui 컴포넌트** 선정
   - [ ] **01-01-01-FE-07-02**: **Button, Input, Form** 컴포넌트 커스터마이징 방안

8. [ ] **01-01-01-FE-08**: 폼 처리 및 검증
   - [ ] **01-01-01-FE-08-01**: **React Hook Form + Zod** 통합 설정
   - [ ] **01-01-01-FE-08-02**: **폼 에러 메시지** 표시 방식 설계

9. [ ] **01-01-01-FE-09**: 에러 핸들링 전략
   - [ ] **01-01-01-FE-09-01**: **API 에러 응답** 처리 전략 (toast, 인라인 에러 등)
   - [ ] **01-01-01-FE-09-02**: **네트워크 에러** 및 타임아웃 처리 방안

10. [ ] **01-01-01-FE-10**: 환경 설정
    - [ ] **01-01-01-FE-10-01**: **Vite 환경 변수** 설정 (.env.local, .env.production)
    - [ ] **01-01-01-FE-10-02**: **API 베이스 URL** 환경별 관리

11. [ ] **01-01-01-FE-11**: 테스트 준비
    - [ ] **01-01-01-FE-11-01**: **Vitest 단위 테스트** 케이스 설계 (Auth Store, API 함수)
    - [ ] **01-01-01-FE-11-02**: **Playwright E2E 테스트** 시나리오 설계

---

## 테스트 분석

### 백엔드 단독 테스트
- **01-01-01-BE-T01**: Postman 등으로 API 명세대로 요청/응답 검증
  - **01-01-01-BE-T01-01**: 로그인 API 정상 케이스 테스트 (test@test.com / password123)
  - **01-01-01-BE-T01-02**: 로그인 API 실패 케이스 테스트 (잘못된 이메일, 비밀번호)
  - **01-01-01-BE-T01-03**: 메인 API 인증 성공 케이스 테스트 (유효한 JWT 토큰)
  - **01-01-01-BE-T01-04**: 메인 API 인증 실패 케이스 테스트 (토큰 없음, 만료된 토큰)

- **01-01-01-BE-T02**: 에러/예외 상황별 응답 검증
  - **01-01-01-BE-T02-01**: 400 Bad Request 응답 테스트 (필수 필드 누락, 형식 오류)
  - **01-01-01-BE-T02-02**: 401 Unauthorized 응답 테스트 (인증 실패 시나리오)
  - **01-01-01-BE-T02-03**: 에러 응답 형식 일관성 테스트 (message, timestamp 필드)

### 프론트엔드 단독 테스트
- **01-01-01-FE-T01**: Mock API로 화면 연동 및 예외 처리 동작 확인
  - **01-01-01-FE-T01-01**: 로그인 폼 렌더링 및 입력 검증 테스트
  - **01-01-01-FE-T01-02**: Mock API 성공 응답 처리 테스트 (토큰 저장, 라우팅)
  - **01-01-01-FE-T01-03**: Mock API 에러 응답 처리 테스트 (에러 메시지 표시)
  - **01-01-01-FE-T01-04**: 보호된 라우트 접근 테스트 (토큰 유무에 따른 동작)

### 통합(BE+FE) 테스트
- **01-01-01-INT-T01**: 실제 API 연동 후, 화면에서 정상/에러 응답 처리 확인
  - **01-01-01-INT-T01-01**: 전체 로그인 플로우 테스트 (폼 입력 → API 호출 → 응답 처리)
  - **01-01-01-INT-T01-02**: 에러 시나리오 통합 테스트 (실제 API 에러 → 화면 에러 표시)
  - **01-01-01-INT-T01-03**: 토큰 기반 인증 통합 테스트 (로그인 → 메인 페이지 접근)

- **01-01-01-INT-T02**: E2E 시나리오(로그인 → 메인 진입) 전체 흐름 검증
  - **01-01-01-INT-T02-01**: 성공 플로우 E2E 테스트 (로그인 → 토큰 획득 → 메인 페이지 진입)
  - **01-01-01-INT-T02-02**: 실패 플로우 E2E 테스트 (잘못된 로그인 → 에러 메시지 표시)
  - **01-01-01-INT-T02-03**: 세션 지속성 테스트 (새로고침, 브라우저 재시작 후 로그인 상태 유지)

## 결과 검증 방법
- API 명세서와 실제 동작이 일치하는지 양팀이 상호 리뷰
- 통합 테스트 결과를 스크린샷/캡처 등으로 기록 